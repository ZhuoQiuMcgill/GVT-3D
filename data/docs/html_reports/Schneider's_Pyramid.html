<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交互式解读：施耐德金字塔六面体剖分难题</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral with Slate Blue Accents -->
    <!-- Application Structure Plan: The application is structured as a single-page interactive dashboard. The flow is designed for progressive disclosure: 1. A hero section for immediate context. 2. A tab-based "Key Challenges" section to break down complex topics (Topology, Geometry, Algorithms) into digestible parts. 3. An interactive chart for comparing "Solutions," transforming static table data into an explorable visualization. 4. A "Core Concepts" section with a clickable diagram to provide on-demand definitions. This structure avoids overwhelming the user with a wall of text, promoting exploration and better understanding of the report's dense academic content. -->
    <!-- Visualization & Content Choices: Report Info -> Goal -> Viz/Method -> Interaction -> Justification. 1. Report's main difficulties -> Organize/Inform -> Tabbed content panes (HTML/JS) -> Click tabs to reveal details -> Breaks down complex problems into manageable themes. 2. Table 2 (Mesh Solutions) -> Compare -> Interactive Bar Chart (Chart.js) -> Toggle data between Hexahedra/Vertices, Hover for details -> Makes quantitative comparisons dynamic and engaging. 3. Core Concepts (Rigidity, Jacobian, etc.) -> Organize/Relationships -> Clickable concept map (HTML/Tailwind/JS) -> Click node to show definition in a side panel -> Provides quick, contextual learning without losing place. All charts use Canvas. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --bg-main: #f8f7f4;
            --bg-card: #ffffff;
            --text-primary: #3d4451;
            --text-secondary: #6c757d;
            --border-color: #e5e7eb;
            --accent-blue: #4a5568;
            --accent-blue-dark: #2c333f;
            --accent-green: #4a7c59;
            --accent-red: #a44e4e;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-primary);
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 320px;
            max-height: 40vh;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 450px;
                max-height: 50vh;
            }
        }

        .nav-link {
            transition: color 0.3s ease, border-bottom-color 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--accent-blue-dark);
            border-bottom-color: var(--accent-blue-dark);
        }

        .tab-button.active {
            background-color: var(--accent-blue);
            color: white;
        }

        .concept-node {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .concept-node:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="antialiased">

<header id="header" class="bg-card/80 backdrop-blur-sm sticky top-0 z-50 border-b border-border-color">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <span class="font-bold text-xl text-accent-blue-dark">施耐德金字塔剖分难题</span>
            </div>
            <div class="hidden md:block">
                <div class="ml-10 flex items-baseline space-x-4">
                    <a href="#introduction"
                       class="nav-link text-gray-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">引言</a>
                    <a href="#challenges"
                       class="nav-link text-gray-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">核心挑战</a>
                    <a href="#solutions"
                       class="nav-link text-gray-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">方案对比</a>
                    <a href="#concepts"
                       class="nav-link text-gray-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">概念深潜</a>
                    <a href="#conclusion"
                       class="nav-link text-gray-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">结论</a>
                </div>
            </div>
        </div>
    </nav>
</header>

<main>
    <section id="introduction" class="py-16 sm:py-24 bg-card">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-accent-blue-dark">一个几何的“终极挑战”</h1>
            <p class="mt-6 text-lg leading-8 text-text-secondary">施耐德金字塔 (Schneider's Pyramid)
                看似简单，却是检验三维网格生成算法能力的试金石。本应用将交互式地解读为何通过在其内部添加顶点来将其完美剖分为六面体，是一个充满拓扑与几何约束的非凡难题。</p>
        </div>
    </section>

    <section id="challenges" class="py-16 sm:py-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight">核心挑战：三大障碍</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-text-secondary">
                    剖分难题源于拓扑、几何和算法三个层面相互交织的严格约束。</p>
            </div>

            <div class="mt-12">
                <div class="flex justify-center border-b border-border-color">
                    <div id="tabs-container" class="flex flex-wrap -mb-px space-x-2 sm:space-x-4" aria-label="Tabs">
                        <button class="tab-button active inline-block p-3 sm:p-4 border-b-2 border-transparent rounded-t-lg font-medium transition-colors"
                                data-tab="topology">🧩 拓扑难题
                        </button>
                        <button class="tab-button inline-block p-3 sm:p-4 border-b-2 border-transparent rounded-t-lg font-medium transition-colors"
                                data-tab="geometry">📐 几何困境
                        </button>
                        <button class="tab-button inline-block p-3 sm:p-4 border-b-2 border-transparent rounded-t-lg font-medium transition-colors"
                                data-tab="algorithm">⚙️ 算法局限
                        </button>
                    </div>
                </div>
                <div id="tabs-content" class="mt-8">
                    <div id="tab-content-topology" class="tab-content space-y-4">
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">结构的““刚性””与连接规则</h3>
                            <p class="mt-2 text-text-secondary">
                                六面体网格具有固有“刚性”，插入一个新顶点需要对周围单元进行复杂的全局性调整，而非简单的局部操作。每个内部四边形面都必须由两个六面体共享，这使得连接方式的组合可能性呈指数级增长，同时极大地限制了自由度。</p>
                        </div>
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">奇异点的产生与管理</h3>
                            <p class="mt-2 text-text-secondary">
                                为了适应金字塔的非立方体形状，剖分中不可避免地会产生“奇异点”（连接边不为4的边）。这些奇异点必须形成符合拓扑定理的特定结构（奇异线），错误地添加内部顶点会创建不可网格化的奇异点构型，导致整个剖分失败。</p>
                        </div>
                    </div>
                    <div id="tab-content-geometry" class="tab-content hidden space-y-4">
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">单元有效性：雅可比行列式约束</h3>
                            <p class="mt-2 text-text-secondary">
                                每个六面体单元从数学上必须是“有效”的，即其雅可比行列式处处为正，否则意味着单元发生了翻转或退化（零体积），在物理模拟中无法使用。在金字塔顶点等几何剧变区域，不恰当的内部顶点放置极易导致雅可比行列式变为负值。</p>
                        </div>
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">单元质量与变形控制</h3>
                            <p class="mt-2 text-text-secondary">
                                即使单元有效，其质量（如长宽比、偏斜度、翘曲度）也至关重要，直接影响计算精度。金字塔的尖端天然地会迫使单元被压缩和拉伸，在附近添加顶点很容易产生质量极差的单元，而优化质量本身就是一个复杂的非线性问题。</p>
                        </div>
                    </div>
                    <div id="tab-content-algorithm" class="tab-content hidden space-y-4">
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">解缠绕 (Untangling) 与平滑 (Smoothing)
                                的困境</h3>
                            <p class="mt-2 text-text-secondary">
                                通常，一个组合上有效的拓扑结构在几何实现后可能包含大量翻转或质量差的单元。需要专门的“解缠绕”算法来修正翻转单元，再通过“平滑”算法优化质量。然而，这些算法并不能保证成功，甚至可能在修复一处问题时，在别处引入新的问题。</p>
                        </div>
                        <div class="bg-card p-6 rounded-lg border border-border-color">
                            <h3 class="font-bold text-xl text-accent-blue-dark">组合爆炸与搜索复杂性</h3>
                            <p class="mt-2 text-text-secondary">
                                寻找一个有效的内部顶点连接方案，本质上是在一个指数级巨大的搜索空间中寻找最优解。确定所需的最少内部顶点数是NP难问题。目前最优的解决方案都依赖于穷举搜索或高度定制化的启发式算法，缺乏普适性。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="solutions" class="py-16 sm:py-24 bg-card">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight">方案对比：单元数量的演进</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-text-secondary">
                    多年来，研究者们提出了多种剖分方案，单元数量不断减少，但都面临着各自的挑战。通过下方图表交互，探索不同方法的权衡。</p>
            </div>

            <div class="mt-12 max-w-5xl mx-auto">
                <div class="flex justify-center items-center mb-6 space-x-2">
                    <span class="text-sm font-medium">图表显示:</span>
                    <div class="flex rounded-md shadow-sm">
                        <button id="show-hex-btn"
                                class="px-4 py-2 bg-accent-blue text-white rounded-l-md text-sm font-semibold">六面体数量
                        </button>
                        <button id="show-vertex-btn"
                                class="px-4 py-2 bg-white text-text-primary border border-l-0 border-border-color rounded-r-md text-sm font-semibold hover:bg-gray-50">
                            内部顶点数
                        </button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="solutionsChart"></canvas>
                </div>
                <p id="chart-caption" class="text-center mt-4 text-sm text-text-secondary">
                    图中虚线表示理论下限（17个六面体）。悬停于条形上可查看生成方法详情。</p>
            </div>
        </div>
    </section>

    <section id="concepts" class="py-16 sm:py-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold tracking-tight">核心概念深潜</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-text-secondary">
                    点击下方卡片，快速理解剖分过程中的关键术语及其相互关系。</p>
            </div>

            <div class="lg:grid lg:grid-cols-3 lg:gap-8 items-start">
                <div class="lg:col-span-2">
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6">
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="rigidity">
                            <span class="text-4xl">🧱</span>
                            <h3 class="mt-2 font-bold">拓扑刚性</h3>
                        </div>
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="singularity">
                            <span class="text-4xl">⚡️</span>
                            <h3 class="mt-2 font-bold">奇异点</h3>
                        </div>
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="jacobian">
                            <span class="text-4xl">✅</span>
                            <h3 class="mt-2 font-bold">雅可比约束</h3>
                        </div>
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="quality">
                            <span class="text-4xl">📉</span>
                            <h3 class="mt-2 font-bold">单元质量</h3>
                        </div>
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="untangling">
                            <span class="text-4xl">🔄</span>
                            <h3 class="mt-2 font-bold">解缠绕</h3>
                        </div>
                        <div class="concept-node cursor-pointer bg-card p-4 rounded-lg shadow-md border border-border-color text-center"
                             data-concept="combinatorial">
                            <span class="text-4xl">🎲</span>
                            <h3 class="mt-2 font-bold">组合爆炸</h3>
                        </div>
                    </div>
                </div>
                <div id="concept-details"
                     class="mt-8 lg:mt-0 lg:col-span-1 bg-card p-6 rounded-lg border border-border-color sticky top-24">
                    <h3 id="concept-title" class="font-bold text-xl text-accent-blue-dark">点击左侧卡片查看详情</h3>
                    <p id="concept-description" class="mt-2 text-text-secondary">此处将显示选中概念的详细解释。</p>
                </div>
            </div>
        </div>
    </section>

    <section id="conclusion" class="py-16 sm:py-24 bg-card">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold tracking-tight text-center">结论：一个持久的挑战</h2>
            <div class="mt-8 space-y-6 text-text-secondary text-justify">
                <p>
                    通过内部添加顶点来剖分施耐德金字塔之所以如此困难，并非单一瓶颈所致，而是源于三维六面体网格剖分固有的、多个深层相互关联的拓扑与几何约束的共同作用。它不是一个简单的局部操作，而是一个具有全局拓扑和几何影响的复杂过程。</p>
                <p>
                    该问题集中体现了结构化六面体单元的期望（规整、高效）与复杂、任意几何形状的现实（不规则、约束多）之间的根本矛盾。施耐德金字塔由于其特定的几何定义和边界条件，将这些普遍存在的张力凝聚在一个紧凑、明确定义但异常困难的基准问题中，持续推动着网格生成领域的发展。</p>
            </div>
        </div>
    </section>

</main>

<script>
    document.addEventListener('DOMContentLoaded', () =>
    {

        const solutionsData = {
            labels: ['146单元网格', '118单元网格', '88单元网格', '44单元网格', '36单元网格'],
            hexahedra: [146, 118, 88, 44, 36],
            vertices: [null, null, null, 18, 23],
            tooltips: [
                '方法: 内部表面生成. 挑战: 恢复凸性导致单元数剧增.',
                '方法: Hexhoop模板. 挑战: 基于模板, 适应性有限, 单元多.',
                '方法: 改进的Hexhoop模板. 挑战: 单元数仍较多.',
                '方法: 约束规划+解缠绕. 挑战: 穷举搜索, 几何解缠绕是关键.',
                '方法: 翻转操作. 挑战: 组合复杂性高, 内部结构不直观.'
            ]
        };

        const conceptDetailsData = {
            rigidity: {
                title: '🧱 拓扑刚性',
                description: '与四面体不同，六面体在网格中不能轻易地进行局部增删。添加一个顶点往往会像推倒多米诺骨牌一样，引发全局性的结构调整，以维持所有面都是四边形且正确连接。'
            },
            singularity: {
                title: '⚡️ 奇异点',
                description: '在非立方体区域，必然会出现非标准的边（连接的六面体不等于4个）。这些奇异点必须形成连续的“奇异线”，其构型受严格的拓扑规则限制，不能随意创建。'
            },
            jacobian: {
                title: '✅ 雅可比约束',
                description: '一个衡量单元是否“翻转”或退化的数学指标。在整个单元内部，雅可比行列式必须为正。在金字塔尖点附近，单元变形剧烈，极易违反此约束，导致网格失效。'
            },
            quality: {
                title: '📉 单元质量',
                description: '除了有效性，单元的形状（如角度、长宽比）也至关重要。低质量单元会严重影响数值模拟的精度和稳定性。优化网格质量往往是一个与拓扑约束相冲突的难题。'
            },
            untangling: {
                title: '🔄 解缠绕',
                description: '即使找到了拓扑上可行的连接方案，其几何实现也可能产生大量“翻转”的无效单元。解缠绕是专门用于修正这些翻转单元的算法，但它计算昂贵且不保证总能成功。'
            },
            combinatorial: {
                title: '🎲 组合爆炸',
                description: '从可用顶点中选择8个来构成一个六面体，其可能的组合数量是天文数字。寻找一个覆盖整个体积且无冲突的六面体集合，是一个计算上极其困难的NP难问题。'
            }
        };

        const chartCaptionEl = document.getElementById('chart-caption');
        const showHexBtn = document.getElementById('show-hex-btn');
        const showVertexBtn = document.getElementById('show-vertex-btn');

        let solutionsChart;

        function createChart(dataType = 'hexahedra')
        {
            const ctx = document.getElementById('solutionsChart').getContext('2d');

            const data = {
                labels: solutionsData.labels,
                datasets: [{
                    label: dataType === 'hexahedra' ? '六面体数量' : '内部顶点数量',
                    data: solutionsData[dataType],
                    backgroundColor: 'rgba(74, 85, 104, 0.6)',
                    borderColor: 'rgba(74, 85, 104, 1)',
                    borderWidth: 1
                }]
            };

            const config = {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {color: 'rgba(0,0,0,0.05)'}
                        },
                        y: {
                            grid: {display: false}
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                afterBody: function (context)
                                {
                                    return solutionsData.tooltips[context[0].dataIndex];
                                }
                            }
                        },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    scaleID: 'x',
                                    value: dataType === 'hexahedra' ? 17 : 18,
                                    borderColor: 'rgb(164, 78, 78)',
                                    borderWidth: 2,
                                    borderDash: [6, 6],
                                    label: {
                                        display: true,
                                        content: dataType === 'hexahedra' ? '理论下限 (17)' : '理论下限 (18)',
                                        position: 'start',
                                        backgroundColor: 'rgba(164, 78, 78, 0.8)'
                                    }
                                }
                            }
                        }
                    }
                }
            };

            if (solutionsChart)
            {
                solutionsChart.destroy();
            }
            solutionsChart = new Chart(ctx, config);
        }

        function updateChart(dataType)
        {
            const newLabel = dataType === 'hexahedra' ? '六面体数量' : '内部顶点数量';
            solutionsChart.data.datasets[0].data = solutionsData[dataType];
            solutionsChart.data.datasets[0].label = newLabel;

            solutionsChart.options.plugins.annotation.annotations.line1.value = dataType === 'hexahedra' ? 17 : 18;
            solutionsChart.options.plugins.annotation.annotations.line1.label.content = dataType === 'hexahedra' ? '理论下限 (17)' : '理论下限 (18)';

            solutionsChart.update();

            if (dataType === 'hexahedra')
            {
                showHexBtn.classList.add('bg-accent-blue', 'text-white');
                showHexBtn.classList.remove('bg-white', 'text-text-primary', 'border', 'border-l-0', 'border-border-color', 'hover:bg-gray-50');
                showVertexBtn.classList.add('bg-white', 'text-text-primary', 'border', 'border-l-0', 'border-border-color', 'hover:bg-gray-50');
                showVertexBtn.classList.remove('bg-accent-blue', 'text-white');
                chartCaptionEl.textContent = '图中虚线表示理论下限（17个六面体）。悬停于条形上可查看生成方法详情。';
            } else
            {
                showVertexBtn.classList.add('bg-accent-blue', 'text-white');
                showVertexBtn.classList.remove('bg-white', 'text-text-primary', 'border', 'border-l-0', 'border-border-color', 'hover:bg-gray-50');
                showHexBtn.classList.add('bg-white', 'text-text-primary', 'border', 'border-border-color', 'hover:bg-gray-50');
                showHexBtn.classList.remove('bg-accent-blue', 'text-white');
                chartCaptionEl.textContent = '图中虚线表示理论下限（18个内部顶点）。部分早期方案未明确报告顶点数。';
            }
        }

        showHexBtn.addEventListener('click', () => updateChart('hexahedra'));
        showVertexBtn.addEventListener('click', () => updateChart('vertices'));

        const tabsContainer = document.getElementById('tabs-container');
        const tabsContent = document.getElementById('tabs-content');
        tabsContainer.addEventListener('click', (e) =>
        {
            if (e.target.matches('.tab-button'))
            {
                tabsContainer.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');

                tabsContent.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                document.getElementById(`tab-content-${e.target.dataset.tab}`).classList.remove('hidden');
            }
        });

        const conceptNodes = document.querySelectorAll('.concept-node');
        const conceptTitleEl = document.getElementById('concept-title');
        const conceptDescriptionEl = document.getElementById('concept-description');
        conceptNodes.forEach(node =>
        {
            node.addEventListener('click', () =>
            {
                const conceptKey = node.dataset.concept;
                const data = conceptDetailsData[conceptKey];
                if (data)
                {
                    conceptTitleEl.innerHTML = data.title;
                    conceptDescriptionEl.textContent = data.description;
                }
            });
        });

        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('section');
        window.addEventListener('scroll', () =>
        {
            let current = '';
            sections.forEach(section =>
            {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 80)
                {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link =>
            {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`)
                {
                    link.classList.add('active');
                }
            });
        });

        createChart();

    });
</script>
</body>
</html>
